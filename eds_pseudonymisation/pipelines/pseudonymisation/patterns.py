from edsnlp.utils.regex import make_pattern

# Phones
delimiters = ["", r"\.", r"\-", " "]
phone_pattern = make_pattern(
    [
        r"((\+ ?3 ?3|0 ?0 ?3 ?3)|0 ?[1-8]) ?" + d.join([r"(\d ?){2}"] * 4)
        for d in delimiters
    ]
)

# IPP
ipp_pattern = r"\b(8(\d ?){9})\b"

# NDA
nda_pattern = (
    r"\b((?:0 ?[159]|1 ?[0146]|2 ?[12689]|3 ?[2368]|4 ?[12479]"
    r"|5 ?3|6 ?[14689]|7 ?[2369]|8 ?[478]|9 ?[0569]|A ?G) ?(\d ?){7,8})\b"
)

# Mail
mail_pattern = r"""(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?: ?\. ?[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*") ?@ ?(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])? ?\. ?)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?) ?\. ?){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])"""  # noqa


# Zip
zip_pattern = r"(\b(?:(?:[0-8] ?[0-9])|(9 ?[0-5])|(2 ?[abAB]))\s?([0-9] ?){3})\b"

# NSS
nss_pattern = (
    r"((?:[1-37-8]) ?(?:([0-9] ?){2}) ?"
    r"(?:0 ?[0-9]|[2-35-9] ?[0-9]|[14] ?[0-2]) ?"
    r"(?:(?:0 ?[1-9]|[1-8] ?[0-9]|9 ?[0-69]|2 ?[abAB]) ?"
    r"(?:0 ?0 ?[1-9]|0 ?[1-9] ?[0-9]|"
    r"[1-8] ?([0-9] ?){2}|9 ?[0-8] ?[0-9]|9 ?9 ?0)|(?:9 ?[78] ?[0-9]) ?"
    r"(?:0 ?[1-9]|[1-8] ?[0-9]|9 ?0) ?)"
    r"(?:0 ?0 ?[1-9]|0 ?[1-9] ?[0-9]|[1-9] ?([0-9] ?){2})"
    r"(?:0 ?[1-9]|[1-8] ?[0-9]|9 ?[0-7]))"
)


patterns = dict(
    # ADRESSE
    # DATE
    # DATE_NAISSANCE
    # HOPITAL
    IPP=ipp_pattern,
    MAIL=mail_pattern,
    NDA=nda_pattern,
    # NOM
    # PRENOM
    SECU=nss_pattern,
    TEL=phone_pattern,
    # VILLE
    ZIP=zip_pattern,
)
